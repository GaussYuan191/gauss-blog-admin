var D=Object.defineProperty,T=Object.defineProperties;var E=Object.getOwnPropertyDescriptors;var k=Object.getOwnPropertySymbols;var I=Object.prototype.hasOwnProperty,j=Object.prototype.propertyIsEnumerable;var v=(e,t,n)=>t in e?D(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,l=(e,t)=>{for(var n in t||(t={}))I.call(t,n)&&v(e,n,t[n]);if(k)for(var n of k(t))j.call(t,n)&&v(e,n,t[n]);return e},x=(e,t)=>T(e,E(t));import{j as r,a as C,F as g,r as h}from"./index.1e18674b.js";import{P as S}from"./page-layout.ad34ff44.js";import{B as f,j as _,v as K,w as P,I as z}from"./api.17a0994e.js";import{D as F,T as L}from"./Table.991498cd.js";import"./index.d09e3fac.js";import"./index.aef76a23.js";import"./index.ac3dbe7f.js";import"./styleChecker.0a04cfc8.js";import"./index.f3179481.js";import"./index.800a318d.js";import"./index.7904e80b.js";import"./index.dd62996c.js";import"./Overflow.d99eac34.js";import"./index.0958ac02.js";import"./Dropdown.51364922.js";import"./index.057e14fb.js";const N=[{title:"#",width:50,key:"tindex",render:(e,t,n)=>r("span",{children:n+1})},{title:"\u6807\u9898",dataIndex:"name",width:400,key:"name",editable:!0},{title:"\u63CF\u8FF0",key:"descript",dataIndex:"descript",editable:!0},{title:"\u7F16\u8F91",dataIndex:"operation",width:150}];const O=e=>{const{editing:t,rowIndex:n,record:a}=e;return r("div",{className:"btnBox",children:t?C(g,{children:[r(f,{type:"link",onClick:()=>e.cancel(),children:"\u53D6\u6D88"}),r(F,{type:"vertical"}),r(f,{type:"link",onClick:()=>e.save(a),children:"\u4FDD\u5B58"})]}):C(g,{children:[r(f,{type:"link",onClick:()=>e.edit(n),children:"\u4FEE\u6539"}),r(F,{type:"vertical"}),r(f,{type:"link",onClick:()=>e.del(a),children:"\u5220\u9664"})]})})},o={},R=e=>{const{editing:t,children:n,col:a,rowIndex:s,record:c}=e;let u=null;if(a&&a.editable){const y=p=>{o[a.key]=p.currentTarget.value,o.index=s};u=t?r(z,{defaultValue:c[a.key],onChange:y}):r("div",{children:c[a.key]})}else u=a&&a.dataIndex==="operation"?r(O,x(l({},e),{editing:t})):n;return r("td",{children:u})},re=()=>{const[e,t]=h.exports.useState([]),[n,a]=h.exports.useState(-1),[s,c]=h.exports.useState(1);h.exports.useEffect(()=>{(async()=>{const{data:i}=await _();t(i.result.list||[]),p()})()},[s]);async function u(i){if(o.index===null)return;let d=l(l({},i),o);await K({_id:d._id,name:d.name,descript:d.descript}),d=null,c(s+1)}function y(i){o.index=null,a(i)}function p(){a(-1)}async function w(i){o.index!==null&&(await P(i._id),c(s+1))}function b(i){return i===n}const B=N.map(i=>i.editable?x(l({},i),{onCell:(d,m)=>({record:d,col:i,rowIndex:m,editing:b(m)})}):i.dataIndex==="operation"?x(l({},i),{onCell:(d,m)=>({col:i,record:d,save:u,edit:y,cancel:p,del:w,rowIndex:m,editing:b(m)})}):i);return r(g,{children:r(S,{title:"\u6807\u7B7E\u5217\u8868",children:r(L,{components:{body:{cell:R}},columns:B,dataSource:e,bordered:!0,size:"middle",rowKey:"_id"})})})};export{re as default};
