import{r as h}from"./index.1e18674b.js";import{u as W}from"./index.0c3edb1e.js";import{d as q}from"./index.f3179481.js";import{v as K}from"./index.aef76a23.js";import{i as Q,u as Y}from"./index.32603921.js";function P(n){var r=h.exports.useRef(n);r.current=h.exports.useMemo(function(){return n},[n]);var e=h.exports.useRef();return e.current||(e.current=function(){for(var t=[],a=0;a<arguments.length;a++)t[a]=arguments[a];return r.current.apply(this,t)}),e.current}var Z=globalThis&&globalThis.__read||function(n,r){var e=typeof Symbol=="function"&&n[Symbol.iterator];if(!e)return n;var t=e.call(n),a,i=[],u;try{for(;(r===void 0||r-- >0)&&!(a=t.next()).done;)i.push(a.value)}catch(l){u={error:l}}finally{try{a&&!a.done&&(e=t.return)&&e.call(t)}finally{if(u)throw u.error}}return i},U=globalThis&&globalThis.__spread||function(){for(var n=[],r=0;r<arguments.length;r++)n=n.concat(Z(arguments[r]));return n},V=function(r,e){var t=e.manual,a=e.ready,i=a===void 0?!0:a,u=e.defaultParams,l=u===void 0?[]:u,f=e.refreshDeps,o=f===void 0?[]:f,s=e.refreshDepsAction,c=h.exports.useRef(!1);return c.current=!1,W(function(){!t&&i&&(c.current=!0,r.run.apply(r,U(l)))},[i]),W(function(){c.current||t||(c.current=!0,s?s():r.refresh())},U(o)),{onBefore:function(){if(!i)return{stopNow:!0}}}};V.onInit=function(n){var r=n.ready,e=r===void 0?!0:r,t=n.manual;return{loading:!t&&e}};var k=V;function I(n,r){if(n===r)return!0;for(var e=0;e<n.length;e++)if(!Object.is(n[e],r[e]))return!1;return!0}function X(n,r){var e=h.exports.useRef({deps:r,obj:void 0,initialized:!1}).current;return(e.initialized===!1||!I(e.deps,r))&&(e.deps=r,e.obj=n(),e.initialized=!0),e.obj}function J(n){var r=h.exports.useRef(n);return r.current=n,r}var rr=function(r){var e=J(r);h.exports.useEffect(function(){return function(){e.current()}},[])},M=rr,F=globalThis&&globalThis.__assign||function(){return F=Object.assign||function(n){for(var r,e=1,t=arguments.length;e<t;e++){r=arguments[e];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(n[a]=r[a])}return n},F.apply(this,arguments)},j=new Map,er=function(r,e,t){var a=j.get(r);a!=null&&a.timer&&clearTimeout(a.timer);var i=void 0;e>-1&&(i=setTimeout(function(){j.delete(r)},e)),j.set(r,F(F({},t),{timer:i}))},nr=function(r){return j.get(r)},E=new Map,tr=function(r){return E.get(r)},ar=function(r,e){E.set(r,e),e.then(function(t){return E.delete(r),t}).catch(function(){E.delete(r)})},T={},ir=function(r,e){T[r]&&T[r].forEach(function(t){return t(e)})},B=function(r,e){return T[r]||(T[r]=[]),T[r].push(e),function(){var a=T[r].indexOf(e);T[r].splice(a,1)}},or=globalThis&&globalThis.__read||function(n,r){var e=typeof Symbol=="function"&&n[Symbol.iterator];if(!e)return n;var t=e.call(n),a,i=[],u;try{for(;(r===void 0||r-- >0)&&!(a=t.next()).done;)i.push(a.value)}catch(l){u={error:l}}finally{try{a&&!a.done&&(e=t.return)&&e.call(t)}finally{if(u)throw u.error}}return i},ur=globalThis&&globalThis.__spread||function(){for(var n=[],r=0;r<arguments.length;r++)n=n.concat(or(arguments[r]));return n},lr=function(r,e){var t=e.cacheKey,a=e.cacheTime,i=a===void 0?5*60*1e3:a,u=e.staleTime,l=u===void 0?0:u,f=e.setCache,o=e.getCache,s=h.exports.useRef(),c=h.exports.useRef(),p=function(g,d){f?f(d):er(g,i,d),ir(g,d.data)},b=function(g,d){return d===void 0&&(d=[]),o?o(d):nr(g)};return X(function(){if(!!t){var v=b(t);v&&Object.hasOwnProperty.call(v,"data")&&(r.state.data=v.data,r.state.params=v.params,(l===-1||new Date().getTime()-v.time<=l)&&(r.state.loading=!1)),s.current=B(t,function(g){r.setState({data:g})})}},[]),M(function(){var v;(v=s.current)===null||v===void 0||v.call(s)}),t?{onBefore:function(g){var d=b(t,g);return!d||!Object.hasOwnProperty.call(d,"data")?{}:l===-1||new Date().getTime()-d.time<=l?{loading:!1,data:d==null?void 0:d.data,returnNow:!0}:{data:d==null?void 0:d.data}},onRequest:function(g,d){var m=tr(t);return m&&m!==c.current?{servicePromise:m}:(m=g.apply(void 0,ur(d)),c.current=m,ar(t,m),{servicePromise:m})},onSuccess:function(g,d){var m;t&&((m=s.current)===null||m===void 0||m.call(s),p(t,{data:g,params:d,time:new Date().getTime()}),s.current=B(t,function(C){r.setState({data:C})}))},onMutate:function(g){var d;t&&((d=s.current)===null||d===void 0||d.call(s),p(t,{data:g,params:r.state.params,time:new Date().getTime()}),s.current=B(t,function(m){r.setState({data:m})}))}}:{}},sr=lr,cr=globalThis&&globalThis.__read||function(n,r){var e=typeof Symbol=="function"&&n[Symbol.iterator];if(!e)return n;var t=e.call(n),a,i=[],u;try{for(;(r===void 0||r-- >0)&&!(a=t.next()).done;)i.push(a.value)}catch(l){u={error:l}}finally{try{a&&!a.done&&(e=t.return)&&e.call(t)}finally{if(u)throw u.error}}return i},fr=globalThis&&globalThis.__spread||function(){for(var n=[],r=0;r<arguments.length;r++)n=n.concat(cr(arguments[r]));return n},dr=function(r,e){var t=e.debounceWait,a=e.debounceLeading,i=e.debounceTrailing,u=e.debounceMaxWait,l=h.exports.useRef(),f=h.exports.useMemo(function(){var o={};return a!==void 0&&(o.leading=a),i!==void 0&&(o.trailing=i),u!==void 0&&(o.maxWait=u),o},[a,i,u]);return h.exports.useEffect(function(){if(t){var o=r.runAsync.bind(r);return l.current=q(function(s){s()},t,f),r.runAsync=function(){for(var s=[],c=0;c<arguments.length;c++)s[c]=arguments[c];return new Promise(function(p,b){var v;(v=l.current)===null||v===void 0||v.call(l,function(){o.apply(void 0,fr(s)).then(p).catch(b)})})},function(){var s;(s=l.current)===null||s===void 0||s.cancel(),r.runAsync=o}}},[t,f]),t?{onCancel:function(){var s;(s=l.current)===null||s===void 0||s.cancel()}}:{}},vr=dr,hr=function(r,e){var t=e.loadingDelay,a=h.exports.useRef();if(!t)return{};var i=function(){a.current&&clearTimeout(a.current)};return{onBefore:function(){return i(),a.current=setTimeout(function(){r.setState({loading:!0})},t),{loading:!1}},onFinally:function(){i()},onCancel:function(){i()}}},gr=hr;function A(){return!!(typeof window!="undefined"&&window.document&&window.document.createElement)}function H(){return A()?document.visibilityState!=="hidden":!0}var R=[];function mr(n){return R.push(n),function(){var e=R.indexOf(n);R.splice(e,1)}}if(A()){var pr=function(){if(!!H())for(var r=0;r<R.length;r++){var e=R[r];e()}};window.addEventListener("visibilitychange",pr,!1)}var br=function(r,e){var t=e.pollingInterval,a=e.pollingWhenHidden,i=a===void 0?!0:a,u=h.exports.useRef(),l=h.exports.useRef(),f=function(){var s;u.current&&clearTimeout(u.current),(s=l.current)===null||s===void 0||s.call(l)};return W(function(){t||f()},[t]),t?{onBefore:function(){f()},onFinally:function(){if(!i&&!H()){l.current=mr(function(){r.refresh()});return}u.current=setTimeout(function(){r.refresh()},t)},onCancel:function(){f()}}:{}},yr=br,_r=globalThis&&globalThis.__read||function(n,r){var e=typeof Symbol=="function"&&n[Symbol.iterator];if(!e)return n;var t=e.call(n),a,i=[],u;try{for(;(r===void 0||r-- >0)&&!(a=t.next()).done;)i.push(a.value)}catch(l){u={error:l}}finally{try{a&&!a.done&&(e=t.return)&&e.call(t)}finally{if(u)throw u.error}}return i},wr=globalThis&&globalThis.__spread||function(){for(var n=[],r=0;r<arguments.length;r++)n=n.concat(_r(arguments[r]));return n};function Tr(n,r){var e=!1;return function(){for(var t=[],a=0;a<arguments.length;a++)t[a]=arguments[a];e||(e=!0,n.apply(void 0,wr(t)),setTimeout(function(){e=!1},r))}}function Pr(){return A()&&typeof navigator.onLine!="undefined"?navigator.onLine:!0}var S=[];function xr(n){return S.push(n),function(){var e=S.indexOf(n);S.splice(e,1)}}if(A()){var z=function(){if(!(!H()||!Pr()))for(var r=0;r<S.length;r++){var e=S[r];e()}};window.addEventListener("visibilitychange",z,!1),window.addEventListener("focus",z,!1)}var Or=function(r,e){var t=e.refreshOnWindowFocus,a=e.focusTimespan,i=a===void 0?5e3:a,u=h.exports.useRef(),l=function(){var o;(o=u.current)===null||o===void 0||o.call(u)};return h.exports.useEffect(function(){if(t){var f=Tr(r.refresh.bind(r),i);u.current=xr(function(){f()})}return function(){l()}},[t,i]),M(function(){l()}),{}},Rr=Or,Sr=function(r,e){var t=e.retryInterval,a=e.retryCount,i=h.exports.useRef(),u=h.exports.useRef(0),l=h.exports.useRef(!1);return a?{onBefore:function(){l.current||(u.current=0),l.current=!1,i.current&&clearTimeout(i.current)},onSuccess:function(){u.current=0},onError:function(){if(u.current+=1,a===-1||u.current<=a){var o=t!=null?t:Math.min(1e3*Math.pow(2,u.current),3e4);i.current=setTimeout(function(){l.current=!0,r.refresh()},o)}else u.current=0},onCancel:function(){u.current=0,i.current&&clearTimeout(i.current)}}:{}},Cr=Sr,$r=q,jr=K,Er="Expected a function";function Fr(n,r,e){var t=!0,a=!0;if(typeof n!="function")throw new TypeError(Er);return jr(e)&&(t="leading"in e?!!e.leading:t,a="trailing"in e?!!e.trailing:a),$r(n,r,{leading:t,maxWait:r,trailing:a})}var Ar=Fr,Dr=globalThis&&globalThis.__read||function(n,r){var e=typeof Symbol=="function"&&n[Symbol.iterator];if(!e)return n;var t=e.call(n),a,i=[],u;try{for(;(r===void 0||r-- >0)&&!(a=t.next()).done;)i.push(a.value)}catch(l){u={error:l}}finally{try{a&&!a.done&&(e=t.return)&&e.call(t)}finally{if(u)throw u.error}}return i},Br=globalThis&&globalThis.__spread||function(){for(var n=[],r=0;r<arguments.length;r++)n=n.concat(Dr(arguments[r]));return n},Wr=function(r,e){var t=e.throttleWait,a=e.throttleLeading,i=e.throttleTrailing,u=h.exports.useRef(),l={};return a!==void 0&&(l.leading=a),i!==void 0&&(l.trailing=i),h.exports.useEffect(function(){if(t){var f=r.runAsync.bind(r);return u.current=Ar(function(o){o()},t,l),r.runAsync=function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];return new Promise(function(c,p){var b;(b=u.current)===null||b===void 0||b.call(u,function(){f.apply(void 0,Br(o)).then(c).catch(p)})})},function(){var o;r.runAsync=f,(o=u.current)===null||o===void 0||o.cancel()}}},[t,a,i]),t?{onCancel:function(){var o;(o=u.current)===null||o===void 0||o.cancel()}}:{}},Lr=Wr,Mr=globalThis&&globalThis.__read||function(n,r){var e=typeof Symbol=="function"&&n[Symbol.iterator];if(!e)return n;var t=e.call(n),a,i=[],u;try{for(;(r===void 0||r-- >0)&&!(a=t.next()).done;)i.push(a.value)}catch(l){u={error:l}}finally{try{a&&!a.done&&(e=t.return)&&e.call(t)}finally{if(u)throw u.error}}return i},Hr=function(){var r=Mr(h.exports.useState({}),2),e=r[1];return h.exports.useCallback(function(){return e({})},[])},Nr=Hr,y=globalThis&&globalThis.__assign||function(){return y=Object.assign||function(n){for(var r,e=1,t=arguments.length;e<t;e++){r=arguments[e];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(n[a]=r[a])}return n},y.apply(this,arguments)},Ur=globalThis&&globalThis.__awaiter||function(n,r,e,t){function a(i){return i instanceof e?i:new e(function(u){u(i)})}return new(e||(e=Promise))(function(i,u){function l(s){try{o(t.next(s))}catch(c){u(c)}}function f(s){try{o(t.throw(s))}catch(c){u(c)}}function o(s){s.done?i(s.value):a(s.value).then(l,f)}o((t=t.apply(n,r||[])).next())})},zr=globalThis&&globalThis.__generator||function(n,r){var e={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},t,a,i,u;return u={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function l(o){return function(s){return f([o,s])}}function f(o){if(t)throw new TypeError("Generator is already executing.");for(;e;)try{if(t=1,a&&(i=o[0]&2?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[o[0]&2,i.value]),o[0]){case 0:case 1:i=o;break;case 4:return e.label++,{value:o[1],done:!1};case 5:e.label++,a=o[1],o=[0];continue;case 7:o=e.ops.pop(),e.trys.pop();continue;default:if(i=e.trys,!(i=i.length>0&&i[i.length-1])&&(o[0]===6||o[0]===2)){e=0;continue}if(o[0]===3&&(!i||o[1]>i[0]&&o[1]<i[3])){e.label=o[1];break}if(o[0]===6&&e.label<i[1]){e.label=i[1],i=o;break}if(i&&e.label<i[2]){e.label=i[2],e.ops.push(o);break}i[2]&&e.ops.pop(),e.trys.pop();continue}o=r.call(n,e)}catch(s){o=[6,s],a=0}finally{t=i=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},Gr=globalThis&&globalThis.__rest||function(n,r){var e={};for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&r.indexOf(t)<0&&(e[t]=n[t]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,t=Object.getOwnPropertySymbols(n);a<t.length;a++)r.indexOf(t[a])<0&&Object.prototype.propertyIsEnumerable.call(n,t[a])&&(e[t[a]]=n[t[a]]);return e},qr=globalThis&&globalThis.__read||function(n,r){var e=typeof Symbol=="function"&&n[Symbol.iterator];if(!e)return n;var t=e.call(n),a,i=[],u;try{for(;(r===void 0||r-- >0)&&!(a=t.next()).done;)i.push(a.value)}catch(l){u={error:l}}finally{try{a&&!a.done&&(e=t.return)&&e.call(t)}finally{if(u)throw u.error}}return i},x=globalThis&&globalThis.__spread||function(){for(var n=[],r=0;r<arguments.length;r++)n=n.concat(qr(arguments[r]));return n},Vr=function(){function n(r,e,t,a){a===void 0&&(a={}),this.serviceRef=r,this.options=e,this.subscribe=t,this.initState=a,this.count=0,this.state={loading:!1,params:void 0,data:void 0,error:void 0},this.state=y(y(y({},this.state),{loading:!e.manual}),a)}return n.prototype.setState=function(r){r===void 0&&(r={}),this.state=y(y({},this.state),r),this.subscribe()},n.prototype.runPluginHandler=function(r){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];var a=this.pluginImpls.map(function(i){var u;return(u=i[r])===null||u===void 0?void 0:u.call.apply(u,x([i],e))}).filter(Boolean);return Object.assign.apply(Object,x([{}],a))},n.prototype.runAsync=function(){for(var r,e,t,a,i,u,l,f,o,s,c=[],p=0;p<arguments.length;p++)c[p]=arguments[p];return Ur(this,void 0,void 0,function(){var b,v,g,d,m,C,D,$,_,w,N;return zr(this,function(O){switch(O.label){case 0:if(this.count+=1,b=this.count,v=this.runPluginHandler("onBefore",c),g=v.stopNow,d=g===void 0?!1:g,m=v.returnNow,C=m===void 0?!1:m,D=Gr(v,["stopNow","returnNow"]),d)return[2,new Promise(function(){})];if(this.setState(y({loading:!0,params:c},D)),C)return[2,Promise.resolve(D.data)];(e=(r=this.options).onBefore)===null||e===void 0||e.call(r,c),O.label=1;case 1:return O.trys.push([1,3,,4]),$=this.runPluginHandler("onRequest",this.serviceRef.current,c).servicePromise,$||($=(N=this.serviceRef).current.apply(N,x(c))),[4,$];case 2:return _=O.sent(),b!==this.count?[2,new Promise(function(){})]:(this.setState({data:_,error:void 0,loading:!1}),(a=(t=this.options).onSuccess)===null||a===void 0||a.call(t,_,c),this.runPluginHandler("onSuccess",_,c),(u=(i=this.options).onFinally)===null||u===void 0||u.call(i,c,_,void 0),b===this.count&&this.runPluginHandler("onFinally",c,_,void 0),[2,_]);case 3:if(w=O.sent(),b!==this.count)return[2,new Promise(function(){})];throw this.setState({error:w,loading:!1}),(f=(l=this.options).onError)===null||f===void 0||f.call(l,w,c),this.runPluginHandler("onError",w,c),(s=(o=this.options).onFinally)===null||s===void 0||s.call(o,c,void 0,w),b===this.count&&this.runPluginHandler("onFinally",c,void 0,w),w;case 4:return[2]}})})},n.prototype.run=function(){for(var r=this,e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.runAsync.apply(this,x(e)).catch(function(a){r.options.onError||console.error(a)})},n.prototype.cancel=function(){this.count+=1,this.setState({loading:!1}),this.runPluginHandler("onCancel")},n.prototype.refresh=function(){this.run.apply(this,x(this.state.params||[]))},n.prototype.refreshAsync=function(){return this.runAsync.apply(this,x(this.state.params||[]))},n.prototype.mutate=function(r){var e;Q(r)?e=r(this.state.data):e=r,this.runPluginHandler("onMutate",e),this.setState({data:e})},n}(),Xr=Vr,L=globalThis&&globalThis.__assign||function(){return L=Object.assign||function(n){for(var r,e=1,t=arguments.length;e<t;e++){r=arguments[e];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(n[a]=r[a])}return n},L.apply(this,arguments)},Jr=globalThis&&globalThis.__rest||function(n,r){var e={};for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&r.indexOf(t)<0&&(e[t]=n[t]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,t=Object.getOwnPropertySymbols(n);a<t.length;a++)r.indexOf(t[a])<0&&Object.prototype.propertyIsEnumerable.call(n,t[a])&&(e[t[a]]=n[t[a]]);return e},Kr=globalThis&&globalThis.__read||function(n,r){var e=typeof Symbol=="function"&&n[Symbol.iterator];if(!e)return n;var t=e.call(n),a,i=[],u;try{for(;(r===void 0||r-- >0)&&!(a=t.next()).done;)i.push(a.value)}catch(l){u={error:l}}finally{try{a&&!a.done&&(e=t.return)&&e.call(t)}finally{if(u)throw u.error}}return i},G=globalThis&&globalThis.__spread||function(){for(var n=[],r=0;r<arguments.length;r++)n=n.concat(Kr(arguments[r]));return n};function Qr(n,r,e){r===void 0&&(r={}),e===void 0&&(e=[]);var t=r.manual,a=t===void 0?!1:t,i=Jr(r,["manual"]),u=L({manual:a},i),l=J(n),f=Nr(),o=X(function(){var s=e.map(function(c){var p;return(p=c==null?void 0:c.onInit)===null||p===void 0?void 0:p.call(c,u)}).filter(Boolean);return new Xr(l,u,f,Object.assign.apply(Object,G([{}],s)))},[]);return o.options=u,o.pluginImpls=e.map(function(s){return s(o,u)}),Y(function(){if(!a){var s=o.state.params||r.defaultParams||[];o.run.apply(o,G(s))}}),M(function(){o.cancel()}),{loading:o.state.loading,data:o.state.data,error:o.state.error,params:o.state.params||[],cancel:P(o.cancel.bind(o)),refresh:P(o.refresh.bind(o)),refreshAsync:P(o.refreshAsync.bind(o)),run:P(o.run.bind(o)),runAsync:P(o.runAsync.bind(o)),mutate:P(o.mutate.bind(o))}}var Yr=globalThis&&globalThis.__read||function(n,r){var e=typeof Symbol=="function"&&n[Symbol.iterator];if(!e)return n;var t=e.call(n),a,i=[],u;try{for(;(r===void 0||r-- >0)&&!(a=t.next()).done;)i.push(a.value)}catch(l){u={error:l}}finally{try{a&&!a.done&&(e=t.return)&&e.call(t)}finally{if(u)throw u.error}}return i},Zr=globalThis&&globalThis.__spread||function(){for(var n=[],r=0;r<arguments.length;r++)n=n.concat(Yr(arguments[r]));return n};function te(n,r,e){return Qr(n,r,Zr(e||[],[vr,gr,yr,Rr,Lr,k,sr,Cr]))}export{te as a,P as u};
