var E=Object.defineProperty,F=Object.defineProperties;var A=Object.getOwnPropertyDescriptors;var b=Object.getOwnPropertySymbols;var j=Object.prototype.hasOwnProperty,S=Object.prototype.propertyIsEnumerable;var C=(t,e,n)=>e in t?E(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,h=(t,e)=>{for(var n in e||(e={}))j.call(e,n)&&C(t,n,e[n]);if(b)for(var n of b(e))S.call(e,n)&&C(t,n,e[n]);return t},p=(t,e)=>F(t,A(e));import{j as a,a as w,F as k,r as x}from"./index.1e18674b.js";import{P as T}from"./page-layout.ad34ff44.js";import{B as y,q as K,r as P,t as _,I as q}from"./api.17a0994e.js";import{D as B,T as z}from"./Table.991498cd.js";import{ag as I}from"./index.aef76a23.js";import"./index.d09e3fac.js";import"./index.ac3dbe7f.js";import"./styleChecker.0a04cfc8.js";import"./index.f3179481.js";import"./index.800a318d.js";import"./index.7904e80b.js";import"./index.dd62996c.js";import"./Overflow.d99eac34.js";import"./index.0958ac02.js";import"./Dropdown.51364922.js";import"./index.057e14fb.js";const L=[{title:"#",width:50,key:"tindex",render:(t,e,n)=>a("span",{children:n})},{title:"\u7559\u8A00\u5185\u5BB9",dataIndex:"content",width:300,key:"content"},{title:"ip\u5730\u5740",key:"ip",dataIndex:"ip",width:200},{title:"\u7559\u8A00\u90AE\u7BB1",key:"author.email",dataIndex:"author.email",width:200,render:(t,e)=>a("span",{children:e.author.email})},{title:"web\u5730\u5740",key:"author.site",dataIndex:"author.site",width:300,render:(t,e)=>a("span",{children:e.author.site})},{title:"\u72B6\u6001",key:"state",dataIndex:"state",editable:!0,width:100},{title:"\u7F16\u8F91",key:"operation",dataIndex:"operation",width:100}];function N(t){const{editing:e,rowIndex:n,record:r}=t;return a("div",{className:"btnbox1",children:e?w(k,{children:[a(y,{type:"link",onClick:()=>t.cancel(),children:"\u53D6\u6D88"}),a(B,{type:"vertical"}),a(y,{type:"link",onClick:()=>t.save(r),children:"\u4FDD\u5B58"})]}):w(k,{children:[a(y,{type:"link",onClick:()=>t.edit(n),children:"\u4FEE\u6539"}),a(B,{type:"vertical"}),a(y,{type:"link",onClick:()=>t.del(r),children:"\u5220\u9664"})]})})}const c={};function O(t){const{editing:e,children:n,col:r,rowIndex:s,record:o}=t;let l=null;if(r&&r.editable&&r.editable){const f=m=>{c[r.key]=m.currentTarget.value,c.index=s};l=e?a(q,{defaultValue:o[r.key],onChange:f}):a("div",{children:o[r.key]})}else l=r&&r.dataIndex==="operation"?a(N,p(h({},t),{editing:e})):n;return a("td",{children:l})}const re=()=>{const[t,e]=x.exports.useState([]),[n,r]=x.exports.useState(-1),[s,o]=x.exports.useState(1);x.exports.useEffect(()=>{(async()=>{const{data:i}=await K();e(i.result.data||[]),m()})()},[s]);async function l(i){if(c.index===null)return;const{data:d}=await P(i._id,{state:c.state});o(s+1),I.success(d.message)}function f(i){c.index=null,r(i)}function m(){r(-1)}async function v(i){const{data:d}=await _(i._id);o(s+1),I.success(d.message)}function g(i){return i===n}const D=L.map(i=>i.editable?p(h({},i),{onCell:(d,u)=>({record:d,col:i,rowIndex:u,editing:g(u)})}):i.dataIndex==="operation"?p(h({},i),{onCell:(d,u)=>({col:i,record:d,save:l,edit:f,cancel:m,del:v,rowIndex:u,editing:g(u)})}):i);return a(k,{children:a(T,{title:"\u8BC4\u8BBA\u7BA1\u7406",children:a(z,{components:{body:{cell:O}},columns:D,dataSource:t,bordered:!0,size:"middle",rowKey:"_id"})})})};export{re as default};
